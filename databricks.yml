# This is a Databricks asset bundle definition for customer-reviews-tool-calling-agent.
# The Databricks extension requires databricks.yml configuration file.
# See https://docs.databricks.com/dev-tools/bundles/index.html for documentation.

bundle:
  name: customer-reviews-tool-calling-agent

# Variables for environment-specific configuration
variables:
  app_name:
    description: "App name"
    default: "amazon-customer-reviews-app"

  model_endpoint_name:
    description: "Databricks model serving endpoint name"
    default: "agents_juan_dev-genai-amazon_review_agent"
  
  user_name:
    description: "User name for permissions"
    default: "juan.lamadrid@databricks.com"

targets:
  dev:
    mode: development
    default: true
    workspace:
      host: https://e2-demo-field-eng.cloud.databricks.com
      root_path: /Workspace/Users/${workspace.current_user.userName}/ml/customer-reviews-tool-calling-agent
    
    resources:
      apps:
        customer-reviews-app:
          name: ${var.app_name}
          description: "Product Reviews powered by Genie."
          resources:
            - name: agent-endpoint
              serving_endpoint:
                name: ${var.model_endpoint_name}
                permission: "CAN_QUERY"
          user_api_scopes: ["serving.serving-endpoints"]
          source_code_path: ./03-app/src
          permissions:
            - level: "CAN_USE"
              user_name: ${var.user_name}

  ## Optionally, there could be 'staging' or 'prod' targets here.
  #
  # prod:
  #   workspace:
  #     host: https://e2-demo-field-eng.cloud.databricks.com
